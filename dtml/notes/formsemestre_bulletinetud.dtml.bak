<dtml-let CSV="REQUEST.form.get('tabformat','html')=='csv'">
<dtml-if "not CSV">
<dtml-unless tabformat><dtml-call "REQUEST.set('tabformat','html')"></dtml-unless>

<dtml-call "REQUEST.set( 'sem', do_formsemestre_list( args={ 'formsemestre_id' : formsemestre_id } )[0])">

<dtml-in "getEtudInfo(etudid=etudid,filled=1)" mapping>

<dtml-var "sco_header(page_title='Bulletin de '+sexe+' '+nom,REQUEST=REQUEST,client=this())">
<table class="bull_head">
<TR><TD>
<h2><dtml-var sexe> <dtml-var prenom> <dtml-var nom> 
(<dtml-var inscription> <dtml-var groupetd>)</h2>

Bulletin <dtml-var "sem['titre']"> établi le <dtml-var "DateTime().strftime('%d/%m/%Y à %Hh%M')"> (notes sur 20)

</td><td class="bull_photo">
<a href="ficheEtud?etudid=<dtml-var etudid>"><dtml-var "etudfoto(foto=foto,etudid=etudid,fototitle='fiche de '+nom)"></a>
</td></tr>
</table>
</dtml-in getEtudInfo>


</dtml-if CSV>
<dtml-var "do_formsemestre_bulletinetud(REQUEST, formsemestre_id, etudid, format=tabformat)">
<dtml-if "not CSV">

<dtml-in "Absences.CountAbs(etudid=etudid,debut=DateDDMMYYYY2ISO(sem['date_debut']),fin=DateDDMMYYYY2ISO(sem['date_fin']))">
<dtml-in "Absences.CountAbsJust(etudid=etudid,debut=DateDDMMYYYY2ISO(sem['date_debut']),fin=DateDDMMYYYY2ISO(sem['date_fin']))">

<p><a href="../Absences/CalAbs?etudid=<dtml-var etudid>" class="bull_link">
<b>Absences :</b> <dtml-var "nbabs"> demi-journées, dont <dtml-var "nbabsjust"> justifiées (pendant ce semestre).
</a></p>
</dtml-in></dtml-in>

<dtml-var sco_footer>
</dtml-if CSV>
</dtml-let CSV>
